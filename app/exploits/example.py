#!/usr/bin/env python
#-*-coding:utf-8-*-

from modules.http import http
from modules.plugins import logger

'''
示例Exploit代码
'''

author = "ushell"

# exploit 标题
title = "xx 漏洞exploit"

# 漏洞/exploit描述(可为空)
description = "xx 漏洞详情"

# 漏洞KB引用(可为空)
reference = "http://xxx 的引用"

# exploit需要设置的参数
options = {
    "target" : "http://www.baidu.com"
}

# 核心函数
def exploit(options):
    # 日志回显
    logger.process("set exploit params...")

    # 获取设置的参数
    url = options["target"]["current_value"]

    logger.process("send request...")
    # 设置header
    headers = {'xxoo':'1111111111111111'}
    # 请求
    response = http.get(url, headers, 1)

    if "success" in response:
        logger.success("exploit success ! :)")
        return True
    else:
        logger.error("exploit fail ! :(")
        return False